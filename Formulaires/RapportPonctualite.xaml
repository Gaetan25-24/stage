<UserControl x:Class="MonProjet.RapportPonctualite"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:local="clr-namespace:MonProjet"
             Background="#F5F5F5"
             mc:Ignorable="d"  d:DesignWidth="950">

    <UserControl.Resources>
        <!-- Styles personnalisés -->
        <Style x:Key="FilterCardStyle" TargetType="materialDesign:Card">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="materialDesign:ElevationAssist.Elevation" Value="Dp1"/>
        </Style>

        <Style x:Key="MetricCardStyle" TargetType="materialDesign:Card">
            <Setter Property="Margin" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="materialDesign:ElevationAssist.Elevation" Value="Dp2"/>
        </Style>

        <Style x:Key="ReportButtonStyle" TargetType="Button">
            <Setter Property="Height" Value="40"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="15,0"/>
        </Style>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="20">
            <!-- Header -->
            <Grid Margin="0,0,0,25">
                <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="ClipboardText" Width="32" Height="32" 
                                           Foreground="#2196F3" VerticalAlignment="Center"/>
                    <TextBlock Text="Rapport de Ponctualité" FontSize="28" FontWeight="Bold" 
                             Foreground="#333" VerticalAlignment="Center" Margin="15,0,0,0"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <materialDesign:PackIcon Kind="Update" Width="16" Height="16" 
                                           Foreground="#666" VerticalAlignment="Center"/>
                    <TextBlock Text="Dernière mise à jour: " VerticalAlignment="Center" 
                             Foreground="#666" Margin="5,0,0,0"/>
                    <TextBlock Name="LastUpdate" Text="05/09/2025 14:35" VerticalAlignment="Center" 
                             FontWeight="Bold"/>
                </StackPanel>
            </Grid>

            <!-- Filtres et période -->
            <materialDesign:Card Margin="0,0,0,20" Padding="20">
                <StackPanel>
                    <TextBlock Text="Filtres et Période d'Analyse" FontSize="16" FontWeight="Bold" 
                             Margin="0,0,0,15"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Période -->
                        <StackPanel Grid.Column="0" Margin="0,0,10,0">
                            <TextBlock Text="Période" FontWeight="Medium" Margin="0,0,0,8"/>
                            <ComboBox Name="PeriodComboBox" materialDesign:HintAssist.Hint="Sélectionner période"
                                    Style="{StaticResource MaterialDesignComboBox}">
                                <ComboBoxItem Content="Cette semaine" IsSelected="True"/>
                                <ComboBoxItem Content="Ce mois"/>
                                <ComboBoxItem Content="Trimestre actuel"/>
                                <ComboBoxItem Content="Année scolaire"/>
                                <ComboBoxItem Content="Période personnalisée"/>
                            </ComboBox>
                        </StackPanel>

                        <!-- Date début -->
                        <StackPanel Grid.Column="1" Margin="10,0,10,0">
                            <TextBlock Text="Date début" FontWeight="Medium" Margin="0,0,0,8"/>
                            <DatePicker Name="StartDatePicker" 
                                      materialDesign:HintAssist.Hint="Date de début"
                                      Style="{StaticResource MaterialDesignDatePicker}"/>
                        </StackPanel>

                        <!-- Date fin -->
                        <StackPanel Grid.Column="2" Margin="10,0,10,0">
                            <TextBlock Text="Date fin" FontWeight="Medium" Margin="0,0,0,8"/>
                            <DatePicker Name="EndDatePicker" 
                                      materialDesign:HintAssist.Hint="Date de fin"
                                      Style="{StaticResource MaterialDesignDatePicker}"/>
                        </StackPanel>

                        <!-- Enseignant -->
                        <StackPanel Grid.Column="3" Margin="10,0,10,0">
                            <TextBlock Text="Enseignant" FontWeight="Medium" Margin="0,0,0,8"/>
                            <ComboBox Name="TeacherFilterComboBox" 
                                    materialDesign:HintAssist.Hint="Tous les enseignants"
                                    Style="{StaticResource MaterialDesignComboBox}">
                                <ComboBoxItem Content="Tous les enseignants" IsSelected="True"/>
                                <ComboBoxItem Content="M. Dupont"/>
                                <ComboBoxItem Content="Mme Martin"/>
                                <ComboBoxItem Content="M. Bernard"/>
                                <ComboBoxItem Content="Mme Rousseau"/>
                                <ComboBoxItem Content="Mme Petit"/>
                            </ComboBox>
                        </StackPanel>

                        <!-- Bouton générer -->
                        <StackPanel Grid.Column="4" Margin="15,0,0,0" VerticalAlignment="Bottom">
                            <Button Name="BtnGenerate" Style="{StaticResource ReportButtonStyle}"
                                  Background="#2196F3" Foreground="White" 
                                  materialDesign:ButtonAssist.CornerRadius="20">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Play" Width="16" Height="16"/>
                                    <TextBlock Text="Générer" Margin="8,0,0,0"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </materialDesign:Card>

            <!-- Métriques globales -->
            <Grid Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <materialDesign:Card Grid.Column="0" Style="{StaticResource MetricCardStyle}">
                    <materialDesign:Card.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#4CAF50" Offset="0"/>
                            <GradientStop Color="#66BB6A" Offset="1"/>
                        </LinearGradientBrush>
                    </materialDesign:Card.Background>

                    <StackPanel HorizontalAlignment="Center">
                        <materialDesign:PackIcon Kind="ClockCheck" Width="32" Height="32" Foreground="White"/>
                        <TextBlock Text="Ponctualité Moyenne" FontSize="14" Foreground="White" 
                   HorizontalAlignment="Center" Margin="0,8,0,0" Opacity="0.9"/>
                        <TextBlock Name="AveragePunctuality" Text="87.5%" FontSize="28" FontWeight="Bold" 
                   Foreground="White" HorizontalAlignment="Center"/>
                        <TextBlock Text="+2.1% vs mois dernier" FontSize="12" Foreground="White" 
                   HorizontalAlignment="Center" Opacity="0.8"/>
                    </StackPanel>
                </materialDesign:Card>


                <materialDesign:Card Grid.Column="0" Style="{StaticResource MetricCardStyle}">
                    <materialDesign:Card.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#FF9800" Offset="0"/>
                            <GradientStop Color="#FFB74D" Offset="1"/>
                        </LinearGradientBrush>
                    </materialDesign:Card.Background>

                    <StackPanel HorizontalAlignment="Center">
                        <materialDesign:PackIcon Kind="ClockCheck" Width="32" Height="32" Foreground="White"/>
                        <TextBlock Text="Ponctualité Moyenne" FontSize="14" Foreground="White" 
                   HorizontalAlignment="Center" Margin="0,8,0,0" Opacity="0.9"/>
                        <TextBlock Name="TotalDelays" Text="87.5%" FontSize="28" FontWeight="Bold" 
                   Foreground="White" HorizontalAlignment="Center"/>
                        <TextBlock Text="+2.1% vs mois dernier" FontSize="12" Foreground="White" 
                   HorizontalAlignment="Center" Opacity="0.8"/>
                    </StackPanel>
                </materialDesign:Card>


                <materialDesign:Card Grid.Column="0" Style="{StaticResource MetricCardStyle}">
                    <materialDesign:Card.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#F44336" Offset="0"/>
                            <GradientStop Color="#EF5350" Offset="1"/>
                        </LinearGradientBrush>
                    </materialDesign:Card.Background>

                    <StackPanel HorizontalAlignment="Center">
                        <materialDesign:PackIcon Kind="ClockCheck" Width="32" Height="32" Foreground="White"/>
                        <TextBlock Text="Ponctualité Moyenne" FontSize="14" Foreground="White" 
                   HorizontalAlignment="Center" Margin="0,8,0,0" Opacity="0.9"/>
                        <TextBlock Name="AverageDelay" Text="87.5%" FontSize="28" FontWeight="Bold" 
                   Foreground="White" HorizontalAlignment="Center"/>
                        <TextBlock Text="+2.1% vs mois dernier" FontSize="12" Foreground="White" 
                   HorizontalAlignment="Center" Opacity="0.8"/>
                    </StackPanel>
                </materialDesign:Card>


                <materialDesign:Card Grid.Column="0" Style="{StaticResource MetricCardStyle}">
                    <materialDesign:Card.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#9C27B0" Offset="0"/>
                            <GradientStop Color="#BA68C8" Offset="1"/>
                        </LinearGradientBrush>
                    </materialDesign:Card.Background>

                    <StackPanel HorizontalAlignment="Center">
                        <materialDesign:PackIcon Kind="ClockCheck" Width="32" Height="32" Foreground="White"/>
                        <TextBlock Text="Ponctualité Moyenne" FontSize="14" Foreground="White" 
                   HorizontalAlignment="Center" Margin="0,8,0,0" Opacity="0.9"/>
                        <TextBlock Name="AffectedTeachers" Text="87.5%" FontSize="28" FontWeight="Bold" 
                   Foreground="White" HorizontalAlignment="Center"/>
                        <TextBlock Text="+2.1% vs mois dernier" FontSize="12" Foreground="White" 
                   HorizontalAlignment="Center" Opacity="0.8"/>
                    </StackPanel>
                </materialDesign:Card>
            </Grid>

            <!-- Graphiques -->
            <Grid Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Évolution de la ponctualité -->
                <materialDesign:Card Grid.Column="0" Margin="0,0,10,0" Padding="20">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                            <materialDesign:PackIcon Kind="TrendingUp" Width="20" Height="20" 
                                                   Foreground="#2196F3" VerticalAlignment="Center"/>
                            <TextBlock Text="Évolution de la Ponctualité (30 derniers jours)" 
                                     FontSize="16" FontWeight="Bold" VerticalAlignment="Center" Margin="10,0,0,0"/>
                        </StackPanel>

                        <!-- Graphique linéaire simulé -->
                        <Grid Height="300" Background="#FAFAFA">
                            <Canvas>
                                <!-- Grille de fond -->
                                <Line X1="40" Y1="50" X2="40" Y2="250" Stroke="#E0E0E0" StrokeThickness="1"/>
                                <Line X1="40" Y1="250" X2="520" Y2="250" Stroke="#E0E0E0" StrokeThickness="1"/>

                                <!-- Lignes de grille horizontales -->
                                <Line X1="40" Y1="210" X2="520" Y2="210" Stroke="#F0F0F0" StrokeThickness="1"/>
                                <Line X1="40" Y1="170" X2="520" Y2="170" Stroke="#F0F0F0" StrokeThickness="1"/>
                                <Line X1="40" Y1="130" X2="520" Y2="130" Stroke="#F0F0F0" StrokeThickness="1"/>
                                <Line X1="40" Y1="90" X2="520" Y2="90" Stroke="#F0F0F0" StrokeThickness="1"/>

                                <!-- Courbe principale (ponctualité) -->
                                <Polyline Points="40,180 80,170 120,160 160,175 200,165 240,155 280,150 320,145 360,140 400,135 440,130 480,125 520,120" 
                                        Stroke="#4CAF50" StrokeThickness="3" Fill="Transparent"/>

                                <!-- Courbe secondaire (retards) -->
                                <Polyline Points="40,200 80,195 120,205 160,190 200,200 240,195 280,185 320,190 360,180 400,175 440,170 480,165 520,160" 
                                        Stroke="#FF5722" StrokeThickness="2" Fill="Transparent" StrokeDashArray="5,3"/>

                                <!-- Points de données -->
                                <Ellipse Canvas.Left="38" Canvas.Top="178" Width="6" Height="6" Fill="#4CAF50"/>
                                <Ellipse Canvas.Left="118" Canvas.Top="158" Width="6" Height="6" Fill="#4CAF50"/>
                                <Ellipse Canvas.Left="198" Canvas.Top="163" Width="6" Height="6" Fill="#4CAF50"/>
                                <Ellipse Canvas.Left="278" Canvas.Top="148" Width="6" Height="6" Fill="#4CAF50"/>
                                <Ellipse Canvas.Left="358" Canvas.Top="138" Width="6" Height="6" Fill="#4CAF50"/>
                                <Ellipse Canvas.Left="438" Canvas.Top="128" Width="6" Height="6" Fill="#4CAF50"/>
                                <Ellipse Canvas.Left="518" Canvas.Top="118" Width="6" Height="6" Fill="#4CAF50"/>

                                <!-- Labels axe Y -->
                                <TextBlock Canvas.Left="10" Canvas.Top="245" Text="60%" FontSize="10" Foreground="#666"/>
                                <TextBlock Canvas.Left="10" Canvas.Top="205" Text="70%" FontSize="10" Foreground="#666"/>
                                <TextBlock Canvas.Left="10" Canvas.Top="165" Text="80%" FontSize="10" Foreground="#666"/>
                                <TextBlock Canvas.Left="10" Canvas.Top="125" Text="90%" FontSize="10" Foreground="#666"/>
                                <TextBlock Canvas.Left="5" Canvas.Top="85" Text="100%" FontSize="10" Foreground="#666"/>

                                <!-- Labels axe X -->
                                <TextBlock Canvas.Left="35" Canvas.Top="260" Text="1" FontSize="10" Foreground="#666"/>
                                <TextBlock Canvas.Left="115" Canvas.Top="260" Text="8" FontSize="10" Foreground="#666"/>
                                <TextBlock Canvas.Left="195" Canvas.Top="260" Text="15" FontSize="10" Foreground="#666"/>
                                <TextBlock Canvas.Left="275" Canvas.Top="260" Text="22" FontSize="10" Foreground="#666"/>
                                <TextBlock Canvas.Left="510" Canvas.Top="260" Text="30" FontSize="10" Foreground="#666"/>
                            </Canvas>
                        </Grid>

                        <!-- Légende -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,15,0,0">
                            <StackPanel Orientation="Horizontal" Margin="0,0,20,0">
                                <Rectangle Width="16" Height="3" Fill="#4CAF50" VerticalAlignment="Center"/>
                                <TextBlock Text="Taux de ponctualité %" FontSize="12" VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <Rectangle Width="16" Height="3" Fill="#FF5722" VerticalAlignment="Center">
                                    <Rectangle.OpacityMask>
                                        <LinearGradientBrush>
                                            <GradientStop Color="Black" Offset="0"/>
                                            <GradientStop Color="Transparent" Offset="0.3"/>
                                            <GradientStop Color="Black" Offset="0.7"/>
                                            <GradientStop Color="Transparent" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Rectangle.OpacityMask>
                                </Rectangle>
                                <TextBlock Text="Nombre de retards" FontSize="12" VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Distribution des retards -->
                <materialDesign:Card Grid.Column="1" Margin="10,0,0,0" Padding="20">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                            <materialDesign:PackIcon Kind="ChartPie" Width="20" Height="20" 
                                                   Foreground="#2196F3" VerticalAlignment="Center"/>
                            <TextBlock Text="Répartition des Retards" FontSize="16" FontWeight="Bold" 
                                     VerticalAlignment="Center" Margin="10,0,0,0"/>
                        </StackPanel>

                        <!-- Graphique en secteurs simulé -->
                        <Grid Height="200" Width="200" HorizontalAlignment="Center">
                            <Ellipse Width="160" Height="160" Fill="#4CAF50" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <Path Fill="#FF9800" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Path.Data>
                                    <PathGeometry>
                                        <PathFigure StartPoint="100,20" IsClosed="True">
                                            <ArcSegment Point="150,60" Size="80,80" SweepDirection="Clockwise" IsLargeArc="False"/>
                                            <LineSegment Point="100,100"/>
                                        </PathFigure>
                                    </PathGeometry>
                                </Path.Data>
                            </Path>
                            <Path Fill="#F44336" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Path.Data>
                                    <PathGeometry>
                                        <PathFigure StartPoint="150,60" IsClosed="True">
                                            <ArcSegment Point="120,170" Size="80,80" SweepDirection="Clockwise" IsLargeArc="False"/>
                                            <LineSegment Point="100,100"/>
                                        </PathFigure>
                                    </PathGeometry>
                                </Path.Data>
                            </Path>
                        </Grid>

                        <!-- Légende du graphique -->
                        <StackPanel Margin="0,15,0,0">
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <Rectangle Width="12" Height="12" Fill="#4CAF50" VerticalAlignment="Center"/>
                                <TextBlock Text="À l'heure (75%)" FontSize="12" VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <Rectangle Width="12" Height="12" Fill="#FF9800" VerticalAlignment="Center"/>
                                <TextBlock Text="Retard (15%)" FontSize="12" VerticalAlignment="Center" Margin="8,0,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </materialDesign:Card>
            </Grid>

            <!-- Tableau détaillé par enseignant -->
            <materialDesign:Card Padding="20">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                        <materialDesign:PackIcon Kind="AccountGroup" Width="20" Height="20" 
                                               Foreground="#2196F3" VerticalAlignment="Center"/>
                        <TextBlock Text="Détail par Enseignant" FontSize="18" FontWeight="Bold" 
                                 VerticalAlignment="Center" Margin="10,0,0,0"/>

                        <!-- Contrôles de tri -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="20,0,0,0">
                            <TextBlock Text="Trier par:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <ComboBox Name="SortComboBox" Width="120" 
                                    Style="{StaticResource MaterialDesignComboBox}">
                                <ComboBoxItem Content="Nom" IsSelected="True"/>
                                <ComboBoxItem Content="Ponctualité"/>
                                <ComboBoxItem Content="Nb. retards"/>
                                <ComboBoxItem Content="Retard moyen"/>
                            </ComboBox>
                        </StackPanel>
                    </StackPanel>

                    <!-- En-têtes -->
                    <Grid Background="#F5F5F5" Height="40">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="200"/>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="120"/>
                            <ColumnDefinition Width="100"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" Text="Enseignant" FontWeight="Bold" 
                                 VerticalAlignment="Center" Margin="15,0,0,0"/>
                        <TextBlock Grid.Column="1" Text="Classe" FontWeight="Bold" 
                                 VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        <TextBlock Grid.Column="2" Text="Jours présents" FontWeight="Bold" 
                                 VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        <TextBlock Grid.Column="3" Text="Ponctualité" FontWeight="Bold" 
                                 VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        <TextBlock Grid.Column="4" Text="Nb. retards" FontWeight="Bold" 
                                 VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        <TextBlock Grid.Column="5" Text="Retard moyen" FontWeight="Bold" 
                                 VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        <TextBlock Grid.Column="6" Text="Tendance" FontWeight="Bold" 
                                 VerticalAlignment="Center" HorizontalAlignment="Center"/>
                    </Grid>

                    <Separator/>

                    <!-- Données des enseignants -->
                    <ScrollViewer MaxHeight="300" VerticalScrollBarVisibility="Auto">
                        <StackPanel Name="TeacherDetailsList">

                            <!-- M. Bernard - Excellent -->
                            <Border BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="0,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0" Margin="15,0,0,0">
                                        <TextBlock Text="M. Bernard" FontWeight="Medium"/>
                                        <TextBlock Text="Sciences" FontSize="11" Foreground="#666"/>
                                    </StackPanel>

                                    <TextBlock Grid.Column="1" Text="CM2-A" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center"/>

                                    <TextBlock Grid.Column="2" Text="22/22" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center" FontWeight="Medium"/>

                                    <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                        <TextBlock Text="96.4%" FontWeight="Bold" Foreground="#4CAF50" HorizontalAlignment="Center"/>
                                        <ProgressBar Value="96.4" Height="4" Width="60" Foreground="#4CAF50"/>
                                    </StackPanel>

                                    <TextBlock Grid.Column="4" Text="1" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center" Foreground="#4CAF50"/>

                                    <TextBlock Grid.Column="5" Text="5 min" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center"/>

                                    <materialDesign:PackIcon Grid.Column="6" Kind="TrendingUp" 
                                                           Foreground="#4CAF50" HorizontalAlignment="Center"/>
                                </Grid>
                            </Border>

                            <!-- Mme Rousseau - Très bien -->
                            <Border BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="0,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0" Margin="15,0,0,0">
                                        <TextBlock Text="Mme Rousseau" FontWeight="Medium"/>
                                        <TextBlock Text="Histoire-Géo" FontSize="11" Foreground="#666"/>
                                    </StackPanel>

                                    <TextBlock Grid.Column="1" Text="CE1-A" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center"/>

                                    <TextBlock Grid.Column="2" Text="21/22" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center" FontWeight="Medium"/>

                                    <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                        <TextBlock Text="91.7%" FontWeight="Bold" Foreground="#8BC34A" HorizontalAlignment="Center"/>
                                        <ProgressBar Value="91.7" Height="4" Width="60" Foreground="#8BC34A"/>
                                    </StackPanel>

                                    <TextBlock Grid.Column="4" Text="2" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center" Foreground="#8BC34A"/>

                                    <TextBlock Grid.Column="5" Text="8 min" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center"/>

                                    <materialDesign:PackIcon Grid.Column="6" Kind="TrendingUp" 
                                                           Foreground="#8BC34A" HorizontalAlignment="Center"/>
                                </Grid>
                            </Border>

                            <!-- Mme Martin - Moyen -->
                            <Border BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="0,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0" Margin="15,0,0,0">
                                        <TextBlock Text="Mme Martin" FontWeight="Medium"/>
                                        <TextBlock Text="Français" FontSize="11" Foreground="#666"/>
                                    </StackPanel>

                                    <TextBlock Grid.Column="1" Text="CM1-B" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center"/>

                                    <TextBlock Grid.Column="2" Text="20/22" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center" FontWeight="Medium"/>

                                    <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                        <TextBlock Text="82.5%" FontWeight="Bold" Foreground="#FF9800" HorizontalAlignment="Center"/>
                                        <ProgressBar Value="82.5" Height="4" Width="60" Foreground="#FF9800"/>
                                    </StackPanel>

                                    <TextBlock Grid.Column="4" Text="5" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center" Foreground="#FF9800"/>

                                    <TextBlock Grid.Column="5" Text="12 min" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center"/>

                                    <materialDesign:PackIcon Grid.Column="6" Kind="TrendingFlat" 
                                                           Foreground="#FF9800" HorizontalAlignment="Center"/>
                                </Grid>
                            </Border>

                            <!-- M. Dupont - À améliorer -->
                            <Border BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="0,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0" Margin="15,0,0,0">
                                        <TextBlock Text="M. Dupont" FontWeight="Medium"/>
                                        <TextBlock Text="Mathématiques" FontSize="11" Foreground="#666"/>
                                    </StackPanel>

                                    <TextBlock Grid.Column="1" Text="CE2-A" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center"/>

                                    <TextBlock Grid.Column="2" Text="18/22" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center" FontWeight="Medium"/>

                                    <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                        <TextBlock Text="68.2%" FontWeight="Bold" Foreground="#F44336" HorizontalAlignment="Center"/>
                                        <ProgressBar Value="68.2" Height="4" Width="60" Foreground="#F44336"/>
                                    </StackPanel>

                                    <TextBlock Grid.Column="4" Text="8" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center" Foreground="#F44336"/>

                                    <TextBlock Grid.Column="5" Text="18 min" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center"/>

                                    <materialDesign:PackIcon Grid.Column="6" Kind="TrendingDown" 
                                                           Foreground="#F44336" HorizontalAlignment="Center"/>
                                </Grid>
                            </Border>

                            <!-- Mme Petit - Bon -->
                            <Border BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="0,12">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0" Margin="15,0,0,0">
                                        <TextBlock Text="Mme Petit" FontWeight="Medium"/>
                                        <TextBlock Text="Arts Plastiques" FontSize="11" Foreground="#666"/>
                                    </StackPanel>

                                    <TextBlock Grid.Column="1" Text="CP-B" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center"/>

                                    <TextBlock Grid.Column="2" Text="22/22" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center" FontWeight="Medium"/>

                                    <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                        <TextBlock Text="86.4%" FontWeight="Bold" Foreground="#8BC34A" HorizontalAlignment="Center"/>
                                        <ProgressBar Value="86.4" Height="4" Width="60" Foreground="#8BC34A"/>
                                    </StackPanel>

                                    <TextBlock Grid.Column="4" Text="3" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center" Foreground="#8BC34A"/>

                                    <TextBlock Grid.Column="5" Text="10 min" VerticalAlignment="Center" 
                                             HorizontalAlignment="Center"/>

                                    <materialDesign:PackIcon Grid.Column="6" Kind="TrendingUp" 
                                                           Foreground="#8BC34A" HorizontalAlignment="Center"/>
                                </Grid>
                            </Border>

                        </StackPanel>
                    </ScrollViewer>
                </StackPanel>
            </materialDesign:Card>

            <!-- Actions et exports -->
            <Grid Margin="0,20,0,0">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                    <Button Style="{StaticResource ReportButtonStyle}" 
                          Background="Transparent" BorderBrush="#2196F3" BorderThickness="1"
                          Foreground="#2196F3">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Printer" Width="18" Height="18"/>
                            <TextBlock Text="Imprimer" Margin="8,0,0,0"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>

        </StackPanel>
    </ScrollViewer>
</UserControl>
